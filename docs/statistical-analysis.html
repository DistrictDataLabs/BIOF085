<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Statistical analysis | Introduction to Data Science using Python</title>
  <meta name="description" content="Chapter 6 Statistical analysis | Introduction to Data Science using Python" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Statistical analysis | Introduction to Data Science using Python" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="araastat/BIOF085" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Statistical analysis | Introduction to Data Science using Python" />
  
  
  

<meta name="author" content="Abhijit Dasgupta, Ph.D." />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualization-using-python.html"/>
<link rel="next" href="machine-learning-using-python.html"/>
<script src="libs/header-attrs-2.1.2/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span. { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html">BIOF 085 Manual</a></li>

<li class="divider"></li>
<li class="part"><span><b>I Introduction and Python Basics</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this guide</a></li>
<li class="chapter" data-level="2" data-path="a-python-primer.html"><a href="a-python-primer.html"><i class="fa fa-check"></i><b>2</b> A Python Primer</a>
<ul>
<li class="chapter" data-level="2.1" data-path="a-python-primer.html"><a href="a-python-primer.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="a-python-primer.html"><a href="a-python-primer.html#python-is-a-modular-language"><i class="fa fa-check"></i><b>2.1.1</b> Python is a modular language</a></li>
<li class="chapter" data-level="2.1.2" data-path="a-python-primer.html"><a href="a-python-primer.html#python-is-a-scripting-language"><i class="fa fa-check"></i><b>2.1.2</b> Python is a scripting language</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="a-python-primer.html"><a href="a-python-primer.html#an-example"><i class="fa fa-check"></i><b>2.2</b> An example</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="a-python-primer.html"><a href="a-python-primer.html#some-general-rules-on-python-syntax"><i class="fa fa-check"></i><b>2.2.1</b> Some general rules on Python syntax</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="a-python-primer.html"><a href="a-python-primer.html#data-types-in-python"><i class="fa fa-check"></i><b>2.3</b> Data types in Python</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="a-python-primer.html"><a href="a-python-primer.html#numeric-variables"><i class="fa fa-check"></i><b>2.3.1</b> Numeric variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="a-python-primer.html"><a href="a-python-primer.html#strings"><i class="fa fa-check"></i><b>2.3.2</b> Strings</a></li>
<li class="chapter" data-level="2.3.3" data-path="a-python-primer.html"><a href="a-python-primer.html#truthiness"><i class="fa fa-check"></i><b>2.3.3</b> Truthiness</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="a-python-primer.html"><a href="a-python-primer.html#data-structures-in-python"><i class="fa fa-check"></i><b>2.4</b> Data structures in Python</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="a-python-primer.html"><a href="a-python-primer.html#lists"><i class="fa fa-check"></i><b>2.4.1</b> Lists</a></li>
<li class="chapter" data-level="2.4.2" data-path="a-python-primer.html"><a href="a-python-primer.html#tuples"><i class="fa fa-check"></i><b>2.4.2</b> Tuples</a></li>
<li class="chapter" data-level="2.4.3" data-path="a-python-primer.html"><a href="a-python-primer.html#dictionaries"><i class="fa fa-check"></i><b>2.4.3</b> Dictionaries</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="a-python-primer.html"><a href="a-python-primer.html#operational-structures-in-python"><i class="fa fa-check"></i><b>2.5</b> Operational structures in Python</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="a-python-primer.html"><a href="a-python-primer.html#loops-and-list-comprehensions"><i class="fa fa-check"></i><b>2.5.1</b> Loops and list comprehensions</a></li>
<li class="chapter" data-level="2.5.2" data-path="a-python-primer.html"><a href="a-python-primer.html#list-comprehensions"><i class="fa fa-check"></i><b>2.5.2</b> List comprehensions</a></li>
<li class="chapter" data-level="2.5.3" data-path="a-python-primer.html"><a href="a-python-primer.html#conditional-evaluations"><i class="fa fa-check"></i><b>2.5.3</b> Conditional evaluations</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="a-python-primer.html"><a href="a-python-primer.html#functions"><i class="fa fa-check"></i><b>2.6</b> Functions</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="a-python-primer.html"><a href="a-python-primer.html#documenting-your-functions"><i class="fa fa-check"></i><b>2.6.1</b> Documenting your functions</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="a-python-primer.html"><a href="a-python-primer.html#modules-and-packages"><i class="fa fa-check"></i><b>2.7</b> Modules and Packages</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="a-python-primer.html"><a href="a-python-primer.html#using-modules"><i class="fa fa-check"></i><b>2.7.1</b> Using modules</a></li>
<li class="chapter" data-level="2.7.2" data-path="a-python-primer.html"><a href="a-python-primer.html#useful-modules-in-pythons-standard-library"><i class="fa fa-check"></i><b>2.7.2</b> Useful modules in Python’s standard library</a></li>
<li class="chapter" data-level="2.7.3" data-path="a-python-primer.html"><a href="a-python-primer.html#installing-third-party-packageslibraries"><i class="fa fa-check"></i><b>2.7.3</b> Installing third-party packages/libraries</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="a-python-primer.html"><a href="a-python-primer.html#environments"><i class="fa fa-check"></i><b>2.8</b> Environments</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="a-python-primer.html"><a href="a-python-primer.html#command-lineshell"><i class="fa fa-check"></i><b>2.8.1</b> Command-line/shell</a></li>
<li class="chapter" data-level="2.8.2" data-path="a-python-primer.html"><a href="a-python-primer.html#using-anaconda-navigator"><i class="fa fa-check"></i><b>2.8.2</b> Using Anaconda Navigator</a></li>
<li class="chapter" data-level="2.8.3" data-path="a-python-primer.html"><a href="a-python-primer.html#reproducing-environments"><i class="fa fa-check"></i><b>2.8.3</b> Reproducing environments</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="a-python-primer.html"><a href="a-python-primer.html#seeking-help"><i class="fa fa-check"></i><b>2.9</b> Seeking help</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="python-tools-for-data-science.html"><a href="python-tools-for-data-science.html"><i class="fa fa-check"></i><b>3</b> Python tools for data science</a>
<ul>
<li class="chapter" data-level="3.1" data-path="python-tools-for-data-science.html"><a href="python-tools-for-data-science.html#the-pydata-stack"><i class="fa fa-check"></i><b>3.1</b> The PyData Stack</a></li>
<li class="chapter" data-level="3.2" data-path="python-tools-for-data-science.html"><a href="python-tools-for-data-science.html#numpy-numerical-and-scientific-computing"><i class="fa fa-check"></i><b>3.2</b> Numpy (numerical and scientific computing)</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="python-tools-for-data-science.html"><a href="python-tools-for-data-science.html#numpy-data-types"><i class="fa fa-check"></i><b>3.2.1</b> Numpy data types</a></li>
<li class="chapter" data-level="3.2.2" data-path="python-tools-for-data-science.html"><a href="python-tools-for-data-science.html#generating-data-in-numpy"><i class="fa fa-check"></i><b>3.2.2</b> Generating data in numpy</a></li>
<li class="chapter" data-level="3.2.3" data-path="python-tools-for-data-science.html"><a href="python-tools-for-data-science.html#vectors-and-matrices"><i class="fa fa-check"></i><b>3.2.3</b> Vectors and matrices</a></li>
<li class="chapter" data-level="3.2.4" data-path="python-tools-for-data-science.html"><a href="python-tools-for-data-science.html#beware-of-copies"><i class="fa fa-check"></i><b>3.2.4</b> Beware of copies</a></li>
<li class="chapter" data-level="3.2.5" data-path="python-tools-for-data-science.html"><a href="python-tools-for-data-science.html#broadcasting-in-python"><i class="fa fa-check"></i><b>3.2.5</b> Broadcasting in Python</a></li>
<li class="chapter" data-level="3.2.6" data-path="python-tools-for-data-science.html"><a href="python-tools-for-data-science.html#conclusions-moving-forward"><i class="fa fa-check"></i><b>3.2.6</b> Conclusions moving forward</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pandas.html"><a href="pandas.html"><i class="fa fa-check"></i><b>4</b> Pandas</a>
<ul>
<li class="chapter" data-level="4.1" data-path="pandas.html"><a href="pandas.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="pandas.html"><a href="pandas.html#starting-pandas"><i class="fa fa-check"></i><b>4.2</b> Starting pandas</a></li>
<li class="chapter" data-level="4.3" data-path="pandas.html"><a href="pandas.html#data-import-and-export"><i class="fa fa-check"></i><b>4.3</b> Data import and export</a></li>
<li class="chapter" data-level="4.4" data-path="pandas.html"><a href="pandas.html#exploring-a-data-set"><i class="fa fa-check"></i><b>4.4</b> Exploring a data set</a></li>
<li class="chapter" data-level="4.5" data-path="pandas.html"><a href="pandas.html#data-structures-and-types"><i class="fa fa-check"></i><b>4.5</b> Data structures and types</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="pandas.html"><a href="pandas.html#pandas.series"><i class="fa fa-check"></i><b>4.5.1</b> pandas.Series</a></li>
<li class="chapter" data-level="4.5.2" data-path="pandas.html"><a href="pandas.html#pandas.dataframe"><i class="fa fa-check"></i><b>4.5.2</b> pandas.DataFrame</a></li>
<li class="chapter" data-level="4.5.3" data-path="pandas.html"><a href="pandas.html#categorical-data"><i class="fa fa-check"></i><b>4.5.3</b> Categorical data</a></li>
<li class="chapter" data-level="4.5.4" data-path="pandas.html"><a href="pandas.html#missing-data"><i class="fa fa-check"></i><b>4.5.4</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="pandas.html"><a href="pandas.html#data-transformation"><i class="fa fa-check"></i><b>4.6</b> Data transformation</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="pandas.html"><a href="pandas.html#arithmetic-operations"><i class="fa fa-check"></i><b>4.6.1</b> Arithmetic operations</a></li>
<li class="chapter" data-level="4.6.2" data-path="pandas.html"><a href="pandas.html#concatenation-of-data-sets"><i class="fa fa-check"></i><b>4.6.2</b> Concatenation of data sets</a></li>
<li class="chapter" data-level="4.6.3" data-path="pandas.html"><a href="pandas.html#merging-data-sets"><i class="fa fa-check"></i><b>4.6.3</b> Merging data sets</a></li>
<li class="chapter" data-level="4.6.4" data-path="pandas.html"><a href="pandas.html#tidy-data-principles-and-reshaping-datasets"><i class="fa fa-check"></i><b>4.6.4</b> Tidy data principles and reshaping datasets</a></li>
<li class="chapter" data-level="4.6.5" data-path="pandas.html"><a href="pandas.html#melting-unpivoting-data"><i class="fa fa-check"></i><b>4.6.5</b> Melting (unpivoting) data</a></li>
<li class="chapter" data-level="4.6.6" data-path="pandas.html"><a href="pandas.html#separating-columns-containing-multiple-variables"><i class="fa fa-check"></i><b>4.6.6</b> Separating columns containing multiple variables</a></li>
<li class="chapter" data-level="4.6.7" data-path="pandas.html"><a href="pandas.html#pivotspread-datasets"><i class="fa fa-check"></i><b>4.6.7</b> Pivot/spread datasets</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="pandas.html"><a href="pandas.html#data-aggregation-and-split-apply-combine"><i class="fa fa-check"></i><b>4.7</b> Data aggregation and split-apply-combine</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html"><i class="fa fa-check"></i><b>5</b> Data visualization using Python</a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#an-example-gallery"><i class="fa fa-check"></i><b>5.1.1</b> An example gallery</a></li>
<li class="chapter" data-level="5.1.2" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#why-visualize-data"><i class="fa fa-check"></i><b>5.1.2</b> Why visualize data?</a></li>
<li class="chapter" data-level="5.1.3" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#conceptual-ideas"><i class="fa fa-check"></i><b>5.1.3</b> Conceptual ideas</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#plotting-in-python"><i class="fa fa-check"></i><b>5.2</b> Plotting in Python</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#static-plots"><i class="fa fa-check"></i><b>5.2.1</b> Static plots</a></li>
<li class="chapter" data-level="5.2.2" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#dynamic-or-interactive-plots"><i class="fa fa-check"></i><b>5.2.2</b> Dynamic or interactive plots</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#univariate-plots"><i class="fa fa-check"></i><b>5.3</b> Univariate plots</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#pandas-1"><i class="fa fa-check"></i><b>5.3.1</b> pandas</a></li>
<li class="chapter" data-level="5.3.2" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#seaborn"><i class="fa fa-check"></i><b>5.3.2</b> seaborn</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#bivariate-plots"><i class="fa fa-check"></i><b>5.4</b> Bivariate plots</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#pandas-2"><i class="fa fa-check"></i><b>5.4.1</b> pandas</a></li>
<li class="chapter" data-level="5.4.2" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#seaborn-1"><i class="fa fa-check"></i><b>5.4.2</b> seaborn</a></li>
<li class="chapter" data-level="5.4.3" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#facets"><i class="fa fa-check"></i><b>5.4.3</b> Facets</a></li>
<li class="chapter" data-level="5.4.4" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#pairs-plots"><i class="fa fa-check"></i><b>5.4.4</b> Pairs plots</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#customizing-the-look"><i class="fa fa-check"></i><b>5.5</b> Customizing the look</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#themes"><i class="fa fa-check"></i><b>5.5.1</b> Themes</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#finer-control-with-matplotlib"><i class="fa fa-check"></i><b>5.6</b> Finer control with matplotlib</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#matlab-like-plotting"><i class="fa fa-check"></i><b>5.6.1</b> Matlab-like plotting</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-visualization-using-python.html"><a href="data-visualization-using-python.html#resources"><i class="fa fa-check"></i><b>5.7</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="statistical-analysis.html"><a href="statistical-analysis.html"><i class="fa fa-check"></i><b>6</b> Statistical analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="statistical-analysis.html"><a href="statistical-analysis.html#introduction-3"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="statistical-analysis.html"><a href="statistical-analysis.html#descriptive-statistics"><i class="fa fa-check"></i><b>6.2</b> Descriptive statistics</a></li>
<li class="chapter" data-level="6.3" data-path="statistical-analysis.html"><a href="statistical-analysis.html#simulation-and-inference"><i class="fa fa-check"></i><b>6.3</b> Simulation and inference</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="statistical-analysis.html"><a href="statistical-analysis.html#simulation-and-hypothesis-testing"><i class="fa fa-check"></i><b>6.3.1</b> Simulation and hypothesis testing</a></li>
<li class="chapter" data-level="6.3.2" data-path="statistical-analysis.html"><a href="statistical-analysis.html#a-permutation-test"><i class="fa fa-check"></i><b>6.3.2</b> A permutation test</a></li>
<li class="chapter" data-level="6.3.3" data-path="statistical-analysis.html"><a href="statistical-analysis.html#testing-many-proteins"><i class="fa fa-check"></i><b>6.3.3</b> Testing many proteins</a></li>
<li class="chapter" data-level="6.3.4" data-path="statistical-analysis.html"><a href="statistical-analysis.html#getting-a-confidence-interval-using-the-bootstrap"><i class="fa fa-check"></i><b>6.3.4</b> Getting a confidence interval using the bootstrap</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="statistical-analysis.html"><a href="statistical-analysis.html#classical-hypothesis-testing"><i class="fa fa-check"></i><b>6.4</b> Classical hypothesis testing</a></li>
<li class="chapter" data-level="6.5" data-path="statistical-analysis.html"><a href="statistical-analysis.html#regression-analysis"><i class="fa fa-check"></i><b>6.5</b> Regression analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="machine-learning-using-python.html"><a href="machine-learning-using-python.html"><i class="fa fa-check"></i><b>7</b> Machine Learning using Python</a>
<ul>
<li class="chapter" data-level="7.1" data-path="machine-learning-using-python.html"><a href="machine-learning-using-python.html#scikit-learn"><i class="fa fa-check"></i><b>7.1</b> Scikit-learn</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="machine-learning-using-python.html"><a href="machine-learning-using-python.html#transforming-the-outcometarget"><i class="fa fa-check"></i><b>7.1.1</b> Transforming the outcome/target</a></li>
<li class="chapter" data-level="7.1.2" data-path="machine-learning-using-python.html"><a href="machine-learning-using-python.html#transforming-the-predictors"><i class="fa fa-check"></i><b>7.1.2</b> Transforming the predictors</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="machine-learning-using-python.html"><a href="machine-learning-using-python.html#the-methods"><i class="fa fa-check"></i><b>7.2</b> The methods</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="machine-learning-using-python.html"><a href="machine-learning-using-python.html#a-quick-example"><i class="fa fa-check"></i><b>7.2.1</b> A quick example</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="machine-learning-using-python.html"><a href="machine-learning-using-python.html#a-data-analytic-example"><i class="fa fa-check"></i><b>7.3</b> A data analytic example</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="string-manipulation.html"><a href="string-manipulation.html"><i class="fa fa-check"></i><b>8</b> String manipulation</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="string-manipulation.html"><a href="string-manipulation.html#string-formatting"><i class="fa fa-check"></i><b>8.0.1</b> String formatting</a></li>
<li class="chapter" data-level="8.1" data-path="string-manipulation.html"><a href="string-manipulation.html#regular-expressions"><i class="fa fa-check"></i><b>8.1</b> Regular expressions</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="string-manipulation.html"><a href="string-manipulation.html#pattern-matching"><i class="fa fa-check"></i><b>8.1.1</b> Pattern matching</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="biopython.html"><a href="biopython.html"><i class="fa fa-check"></i><b>9</b> BioPython</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Data Science using Python</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistical-analysis" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Statistical analysis</h1>
<div id="introduction-3" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduction</h2>
<p>Statistical analysis usually encompasses 3 activities in a data science workflow. These are (a) descriptive analysis, (b) hypothesis testing and (c) statistical modeling. Descriptive analysis refers to a description of the data, which includes computing summary statistics and drawing plots. Hypothesis testing usually refers to statistically seeing if two (or more) groups are different from each other based on some metrics. Modeling refers to fitting a curve to the data to describe the relationship patterns of different variables in a data set.</p>
<p>In terms of Python packages that can address these three tasks:</p>
<table>
<thead>
<tr class="header">
<th align="left">Task</th>
<th>Packages</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Descriptive statistics</td>
<td>pandas, numpy, matplotlib, seaborn</td>
</tr>
<tr class="even">
<td align="left">Hypothesis testing</td>
<td>scipy, statsmodels</td>
</tr>
<tr class="odd">
<td align="left">Modeling</td>
<td>statsmodels, lifelines, scikit-learn</td>
</tr>
</tbody>
</table>
</div>
<div id="descriptive-statistics" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Descriptive statistics</h2>
<p>Descriptive statistics that are often computed are the mean, median, standard deviation, inter-quartile range, pairwise correlations, and the like. Most of these functions are available in <code>numpy</code>, and hence are available in <code>pandas</code>. We have already seen how we can compute these statistics and have even computed grouped statistics. For example, we will compute these using the diamonds dataset</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb671-1"><a href="statistical-analysis.html#cb671-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb671-2"><a href="statistical-analysis.html#cb671-2"></a><span class="im">import</span> scipy <span class="im">as</span> sc</span>
<span id="cb671-3"><a href="statistical-analysis.html#cb671-3"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb671-4"><a href="statistical-analysis.html#cb671-4"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb671-5"><a href="statistical-analysis.html#cb671-5"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code></pre></div>
<div class="sourceCode" id="cb672"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb672-1"><a href="statistical-analysis.html#cb672-1"></a>diamonds <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/diamonds.csv.gz&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb673"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb673-1"><a href="statistical-analysis.html#cb673-1"></a>diamonds.groupby(<span class="st">&#39;color&#39;</span>)[<span class="st">&#39;price&#39;</span>].agg([np.mean, np.median, np.std])</span></code></pre></div>
<pre><code>              mean  median          std
color                                  
D      3169.954096  1838.0  3356.590935
E      3076.752475  1739.0  3344.158685
F      3724.886397  2343.5  3784.992007
G      3999.135671  2242.0  4051.102846
H      4486.669196  3460.0  4215.944171
I      5091.874954  3730.0  4722.387604
J      5323.818020  4234.0  4438.187251</code></pre>
<p>There were other examples we saw yesterday along these lines. Refer to both the <code>python_tools_ds</code> and <code>python_pandas</code> documents</p>
</div>
<div id="simulation-and-inference" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Simulation and inference</h2>
<p>Hypothesis testing is one of the areas where statistics is often used. There are functions for a lot of the standard statistical tests in <code>scipy</code> and <code>statsmodels</code>. However, I’m going to take a little detour to see if we can get some understanding of hypothesis tests using the powerful simulation capabilities of Python. We’ll visit the in-built functions available in <code>scipy</code> and <code>statsmodels</code> as well.</p>
<div id="simulation-and-hypothesis-testing" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Simulation and hypothesis testing</h3>
<p><strong>Question:</strong> You have a coin and you flip it 100 times. You get 54 heads. How likely is it that you have a fair coin?</p>
<p>We can simulate this process, which is random, using Python. The process of heads and tails from coin tosses can be modeled as a <a href="https://en.wikipedia.org/wiki/Binomial_distribution"><strong>binomial</strong> distribution</a>. We can repeat this experiment many many times on our computer, making the assumption that we have a fair coin, and then seeing how likely what we observed is under that assumption.</p>
<blockquote>
<p>Simulation under reasonable assumptions is a great way to understand our data and the underlying data generating processes. In the modern era, it has most famously been used by Nate Silver of ESPN to simulate national elections in the US. There are many examples in engineering where simulations are done to understand a technology and figure out its tolerances and weaknesses, like in aircraft testing. It is also commonly used in epidemic modeling to help understand how an epidemic would spread under different conditions.</p>
</blockquote>
<div class="sourceCode" id="cb675"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb675-1"><a href="statistical-analysis.html#cb675-1"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">205</span>) <span class="co"># Seed the random number generator</span></span>
<span id="cb675-2"><a href="statistical-analysis.html#cb675-2"></a></span>
<span id="cb675-3"><a href="statistical-analysis.html#cb675-3"></a>x <span class="op">=</span> rng.binomial(<span class="dv">100</span>, <span class="fl">0.5</span>, <span class="dv">100000</span>) <span class="co"># Simulate 100,000 experiments of tossing a fair coin 100 times</span></span>
<span id="cb675-4"><a href="statistical-analysis.html#cb675-4"></a></span>
<span id="cb675-5"><a href="statistical-analysis.html#cb675-5"></a>sns.distplot(x, kde<span class="op">=</span><span class="va">True</span>, rug<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb675-6"><a href="statistical-analysis.html#cb675-6"></a>plt.axvline(<span class="dv">54</span>, color <span class="op">=</span> <span class="st">&#39;r&#39;</span>)<span class="op">;</span> <span class="co"># What we observed</span></span>
<span id="cb675-7"><a href="statistical-analysis.html#cb675-7"></a>plt.xlabel(<span class="st">&#39;Number of heads&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb676"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb676-1"><a href="statistical-analysis.html#cb676-1"></a>pd.Series(x).describe() <span class="co"># We convert to pd.Series to take advantage of the `describe` function.</span></span></code></pre></div>
<pre><code>count    100000.000000
mean         49.995590
std           5.011938
min          27.000000
25%          47.000000
50%          50.000000
75%          53.000000
max          72.000000
dtype: float64</code></pre>
<p>What we see from the histogram and the description of the data above is the patterns in data we would expect if we repeated this random experiment. We can already make some observations. First, we do see that the average number of heads we expect to get is 50, which validates that our experiment is using a fair coin. Second, we can reasonably get as few as 27 heads and as many as 72 heads even with a fair coin. In fact, we could look at what values we would expect to see 95% of the time.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb678-1"><a href="statistical-analysis.html#cb678-1"></a>np.quantile(x, [<span class="fl">0.025</span>, <span class="fl">0.975</span>])</span></code></pre></div>
<pre><code>array([40., 60.])</code></pre>
<p>This says that 95% of the time we’ll see values between 40 and 60. (This is <strong>not</strong> a confidence interval. This is the actual results of a simulation study. A confidence interval would be computed based on a <strong>single</strong> experiment, assuming a binomial distribution. We’ll come to that later).</p>
<p>So how likely would we be to see the 54 heads in 100 tosses assuming a fair coin? This can be computed as the proportion of experiments</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb680-1"><a href="statistical-analysis.html#cb680-1"></a>np.mean(x <span class="op">&gt;</span> <span class="dv">54</span>) <span class="co"># convince yourself of this</span></span></code></pre></div>
<pre><code>0.18456</code></pre>
<p>This is what would be considered the <em>p-value</em> for the test that the coin is fair.</p>
<blockquote>
<p>The p-value of a statistical hypothesis test is the likelihood that we would see an outcome at least as extreme as we observed under the assumption that the null hypothesis (H<sub>0</sub>) that we chose is actually true.</p>
<p>In our case, that null hypothesis is that the coin we’re tossing is fair. The p-value <strong>only</strong> gives evidence against the null hypothesis, but does <strong>not</strong> give evidence for the null hypothesis. In other words, if the p-value is small (smaller than some threshold we deem reasonable), then we can claim evidence against the null hypothesis, but if the p-value is large, we cannot say the null hypothesis is true.</p>
</blockquote>
<p>What happens if we increase the number of tosses, and we look at the proportion of heads. We observe 54% heads.</p>
<div class="sourceCode" id="cb682"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb682-1"><a href="statistical-analysis.html#cb682-1"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">205</span>)</span>
<span id="cb682-2"><a href="statistical-analysis.html#cb682-2"></a>x <span class="op">=</span> rng.binomial(<span class="dv">10000</span>, <span class="fl">0.5</span>, <span class="dv">100000</span>)<span class="op">/</span><span class="dv">10000</span></span>
<span id="cb682-3"><a href="statistical-analysis.html#cb682-3"></a>sns.distplot(x)</span>
<span id="cb682-4"><a href="statistical-analysis.html#cb682-4"></a>plt.axvline(<span class="fl">0.54</span>, color <span class="op">=</span> <span class="st">&#39;r&#39;</span>)</span>
<span id="cb682-5"><a href="statistical-analysis.html#cb682-5"></a>plt.xlabel(<span class="st">&#39;Proportion of heads&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb683"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb683-1"><a href="statistical-analysis.html#cb683-1"></a>pd.Series(x).describe()</span></code></pre></div>
<pre><code>count    100000.000000
mean          0.499991
std           0.004994
min           0.478100
25%           0.496600
50%           0.500000
75%           0.503400
max           0.520300
dtype: float64</code></pre>
<p>Well, that changed the game significantly. If we up the number of coin tosses per experiment to 10,000, so 100-fold increase, then we do not see very much variation in the proportion of tosses that are heads.</p>
<blockquote>
<p>This is expected behavior because of a statistical theorem called the <em>Law of Large Numbers</em>, which essentially says that if you do larger and larger sized random experiments with the same experimental setup, your estimate of the true population parameter (in this case the true chance of getting a head, or 0.5 for a fair coin) will become more and more precise.</p>
</blockquote>
<p>Now we see that for a fair coin, we should reasonably see between 47.8% and 52% of tosses should be heads. This is quite an improvement from the 27%-72% range we saw with 100 tosses.</p>
<p>We can compute our p-value in the same way as before.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb685-1"><a href="statistical-analysis.html#cb685-1"></a>np.mean(x <span class="op">&gt;</span> <span class="fl">0.54</span>)</span></code></pre></div>
<pre><code>0.0</code></pre>
<p>So we would never see 54% of our tosses be heads if we tossed a fair coin 10,000 times. Now, with a larger experiment, we would <strong>reject</strong> our null hypothesis H<sub>0</sub> that we have a fair coin.</p>
<p>So same observation, but more data, changes our <em>inference</em> from not having sufficient evidence to say that the coin isn’t fair to saying that it isn’t fair quite definitively. This is directly due to the increased precision of our estimates and thus our ability to differentiate between much smaller differences in the truth.</p>
<p>Let’s see a bit more about what’s going on here. Suppose we assume that the coin’s true likelihood of getting a head is really 0.55, so a very small bias towards heads.</p>
<blockquote>
<p>Food for thought: Is the difference between 0.50 and 0.54 worth worrying about? It probably depends.</p>
</blockquote>
<p>We’re going to compare what we would reasonably see over many repeated experiments given the coin has a 0.50 (fair) and a 0.55 (slightly biased) chance of a head. First, we’ll do experiments of 100 tosses of a coin.</p>
<div class="sourceCode" id="cb687"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb687-1"><a href="statistical-analysis.html#cb687-1"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">205</span>)</span>
<span id="cb687-2"><a href="statistical-analysis.html#cb687-2"></a>x11 <span class="op">=</span> rng.binomial(<span class="dv">100</span>, <span class="fl">0.5</span>, <span class="dv">100000</span>)<span class="op">/</span><span class="dv">100</span> <span class="co"># Getting proportion of heads</span></span>
<span id="cb687-3"><a href="statistical-analysis.html#cb687-3"></a>x12 <span class="op">=</span> rng.binomial(<span class="dv">100</span>, <span class="fl">0.55</span>, <span class="dv">100000</span>)<span class="op">/</span><span class="dv">100</span> </span>
<span id="cb687-4"><a href="statistical-analysis.html#cb687-4"></a></span>
<span id="cb687-5"><a href="statistical-analysis.html#cb687-5"></a>sns.distplot(x11, label <span class="op">=</span> <span class="st">&#39;Fair&#39;</span>)</span>
<span id="cb687-6"><a href="statistical-analysis.html#cb687-6"></a>sns.distplot(x12, label <span class="op">=</span> <span class="st">&#39;Biased&#39;</span>)</span></code></pre></div>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot object at 0x11fa4a640&gt;</code></pre>
<div class="sourceCode" id="cb689"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb689-1"><a href="statistical-analysis.html#cb689-1"></a>plt.xlabel(<span class="st">&#39;Proportion of heads&#39;</span>)</span>
<span id="cb689-2"><a href="statistical-analysis.html#cb689-2"></a>plt.legend()<span class="op">;</span></span></code></pre></div>
<p>We see that there is a great deal of overlap in the potential outcomes over 100,000 repetitions of these experiments, so we have a lot of uncertainty about which model (fair or biased) is the truth.</p>
<p>Now, if we up our experiment to 10,000 tosses of each coin, and again repeat the experiment 100,000 times,</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb690-1"><a href="statistical-analysis.html#cb690-1"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">205</span>)</span>
<span id="cb690-2"><a href="statistical-analysis.html#cb690-2"></a>x21 <span class="op">=</span> rng.binomial(<span class="dv">10000</span>, <span class="fl">0.5</span>, <span class="dv">100000</span>)<span class="op">/</span><span class="dv">10000</span></span>
<span id="cb690-3"><a href="statistical-analysis.html#cb690-3"></a>x22 <span class="op">=</span> rng.binomial(<span class="dv">10000</span>, <span class="fl">0.55</span>, <span class="dv">100000</span>)<span class="op">/</span><span class="dv">10000</span></span>
<span id="cb690-4"><a href="statistical-analysis.html#cb690-4"></a></span>
<span id="cb690-5"><a href="statistical-analysis.html#cb690-5"></a>sns.distplot(x21, label <span class="op">=</span> <span class="st">&#39;Fair&#39;</span>)</span>
<span id="cb690-6"><a href="statistical-analysis.html#cb690-6"></a>sns.distplot(x22, label <span class="op">=</span> <span class="st">&#39;Biased&#39;</span>)</span></code></pre></div>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot object at 0x12e85adc0&gt;</code></pre>
<div class="sourceCode" id="cb692"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb692-1"><a href="statistical-analysis.html#cb692-1"></a>plt.xlabel(<span class="st">&#39;Proportion of heads&#39;</span>)</span>
<span id="cb692-2"><a href="statistical-analysis.html#cb692-2"></a>plt.legend()<span class="op">;</span></span></code></pre></div>
<p>We now find almost no overlap between the potential outcomes, so we can very easily distinguish the two models. This is part of what gathering more data (number of tosses) buys you.</p>
<p>We typically measure this ability to distinguish between two models using concepts of <em>statistical power</em>, which is the likelihood that we would find an observation at least as extreme as what we observed, under the <strong>alternative</strong> model (in this case, the biased coin model). We can calculate the statistical power quite easily for the two sets of simulated experiments. Remember, we observed 54% heads in our one instance of each experiment that we actually observed. By doing simulations, we’re “playing God” and seeing what could have happened, but in practice we only do the experiment once (how many clinical trials of an expensive drug would you really want to do?).</p>
<div class="sourceCode" id="cb693"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb693-1"><a href="statistical-analysis.html#cb693-1"></a>pval1 <span class="op">=</span> np.mean(x11 <span class="op">&gt;</span> <span class="fl">0.54</span>)</span>
<span id="cb693-2"><a href="statistical-analysis.html#cb693-2"></a>pval2 <span class="op">=</span> np.mean(x21 <span class="op">&gt;</span> <span class="fl">0.54</span>)</span>
<span id="cb693-3"><a href="statistical-analysis.html#cb693-3"></a></span>
<span id="cb693-4"><a href="statistical-analysis.html#cb693-4"></a>power1 <span class="op">=</span> np.mean(x12 <span class="op">&gt;</span> <span class="fl">0.54</span>)</span>
<span id="cb693-5"><a href="statistical-analysis.html#cb693-5"></a>power2 <span class="op">=</span> np.mean(x22 <span class="op">&gt;</span> <span class="fl">0.54</span>)</span>
<span id="cb693-6"><a href="statistical-analysis.html#cb693-6"></a></span>
<span id="cb693-7"><a href="statistical-analysis.html#cb693-7"></a><span class="bu">print</span>(<span class="st">&#39;The p-value when n=100 is &#39;</span>, np.<span class="bu">round</span>(pval1, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>The p-value when n=100 is  0.18</code></pre>
<div class="sourceCode" id="cb695"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb695-1"><a href="statistical-analysis.html#cb695-1"></a><span class="bu">print</span>(<span class="st">&#39;The p-value when n=10,000 is &#39;</span>, np.<span class="bu">round</span>(pval2, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>The p-value when n=10,000 is  0.0</code></pre>
<div class="sourceCode" id="cb697"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb697-1"><a href="statistical-analysis.html#cb697-1"></a><span class="bu">print</span>(<span class="st">&#39;Statistical power when n=100 is &#39;</span>, np.<span class="bu">round</span>(power1, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>Statistical power when n=100 is  0.54</code></pre>
<div class="sourceCode" id="cb699"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb699-1"><a href="statistical-analysis.html#cb699-1"></a><span class="bu">print</span>(<span class="st">&#39;Statistical power when n=10,000 is &#39;</span>, np.<span class="bu">round</span>(power2, <span class="dv">2</span>))</span></code></pre></div>
<pre><code>Statistical power when n=10,000 is  0.98</code></pre>
<p>So as <em>n</em> goes up, the p-value for the same experimental outcome goes down and the statistical power goes up. This is a general rule with increasing sample size.</p>
<p>This idea can be used to design a two-armed experiment. Suppose we are looking at the difference in proportion of mice who gained weight between a wild-type mouse and a knockout variant. Since mice are expensive, let’s limit the number of mice we’ll use in each arm to 10. We expect 30% of the wild-type mice to gain weight, and expect a higher proportion of the knockouts will gain weight. This is again the setup for a binomial experiment, with the number of “coin tosses” being 10 for each of the arms. We’re going to do two sets of experiments, one for the WT and one for the KO, and see the difference in proportions of weight gain (‘heads’) between them, and repeat it 100,000 times.</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb701-1"><a href="statistical-analysis.html#cb701-1"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">304</span>)</span>
<span id="cb701-2"><a href="statistical-analysis.html#cb701-2"></a>N <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb701-3"><a href="statistical-analysis.html#cb701-3"></a>weight_gain_wt0 <span class="op">=</span> rng.binomial(N, <span class="fl">0.3</span>, <span class="dv">100000</span>)<span class="op">/</span>N <span class="co"># Get proportion</span></span>
<span id="cb701-4"><a href="statistical-analysis.html#cb701-4"></a>weight_gain_ko0 <span class="op">=</span> rng.binomial(N, <span class="fl">0.3</span>, <span class="dv">100000</span>)<span class="op">/</span>N <span class="co"># Assume first (null hypothesis) that there is no difference</span></span>
<span id="cb701-5"><a href="statistical-analysis.html#cb701-5"></a></span>
<span id="cb701-6"><a href="statistical-analysis.html#cb701-6"></a>diff_weight_gain0 <span class="op">=</span> weight_gain_ko0 <span class="op">-</span> weight_gain_wt0</span>
<span id="cb701-7"><a href="statistical-analysis.html#cb701-7"></a>sns.distplot(diff_weight_gain0, kde<span class="op">=</span><span class="va">False</span>)<span class="op">;</span> <span class="co"># Since we only have 10 mice each, this histogram is not very smooth. </span></span>
<span id="cb701-8"><a href="statistical-analysis.html#cb701-8"></a>                                           <span class="co"># No matter!</span></span></code></pre></div>
<p><img src="BIOF085_Manual_files/figure-html/04-python-stat-14-1.png" /><!-- --></p>
<p>We usually design the actual test by choosing a cutoff in the difference in proportions and stating that we will reject the null hypothesis if our observed difference exceeds this cutoff. We choose the cutoff so that the p-value of the cutoff is some pre-determined error rate, typically 0.05 or 5% (This is not golden or set in stone. We’ll discuss this later). Let’s find that cutoff from this simulation. This will correspond to the 95th percentile of this simulated distribution.</p>
<div class="sourceCode" id="cb702"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb702-1"><a href="statistical-analysis.html#cb702-1"></a>np.<span class="bu">round</span>(np.quantile(diff_weight_gain0, <span class="fl">0.95</span>), <span class="dv">2</span>)</span></code></pre></div>
<pre><code>0.3</code></pre>
<p>This means that at least 5% of the values will be 0.3 or bigger. In fact, this proportion is</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb704-1"><a href="statistical-analysis.html#cb704-1"></a>np.mean(diff_weight_gain0 <span class="op">&gt;</span> <span class="fl">0.3</span>)</span></code></pre></div>
<pre><code>0.06673</code></pre>
<p>So we’ll take 0.3 as the cutoff for our test (It’s fine if the Type 1 error is more than 0.05. If we take the next largest value in the simulation, we dip below 0.05). We’re basically done specifying the testing rule.</p>
<p>What we (and reviewers) like to know at this point is, what is the difference level for which you might get 80% power. The thinking is that if the true difference was, say, <em>p &gt; 0</em> rather than 0 (under the null hypothesis), we would reject the null hypothesis, i.e., get our observed difference to be more than 0.3, at least 80% of the time. We want to find out how big that value of <em>p</em> is. In other words, what is the level of difference in proportions at which we can be reasonably certain that our test will REJECT H<sub>0</sub>, given our sample size, when the true difference in proportions is <em>p</em>. Another way of saying this is how big does the difference in true proportions have to be before we would be fairly confident statistically of distinguishing that we have a difference between the two groups given our chosen sample size, i.e., fairly small overlaps in the two competing distributions.</p>
<p>We can also do this using simulation, by keeping the WT group at 0.3, increasing the KO group gradually, simulating the distribution of the difference in proportion and seeing at what point we get to a statistical power of about 80%. Recall, we’ve already determined that our test will reject H<sub>0</sub> when the observed difference is greater than 0.3</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb706-1"><a href="statistical-analysis.html#cb706-1"></a>p1 <span class="op">=</span> np.linspace(<span class="fl">0.3</span>, <span class="fl">0.9</span>, <span class="dv">100</span>)</span>
<span id="cb706-2"><a href="statistical-analysis.html#cb706-2"></a>power <span class="op">=</span> np.zeros(<span class="bu">len</span>(p1))</span>
<span id="cb706-3"><a href="statistical-analysis.html#cb706-3"></a><span class="cf">for</span> i, p <span class="kw">in</span> <span class="bu">enumerate</span>(p1):</span>
<span id="cb706-4"><a href="statistical-analysis.html#cb706-4"></a>    weight_gain_wt1 <span class="op">=</span> rng.binomial(N, <span class="fl">0.3</span>, <span class="dv">100000</span>)<span class="op">/</span>N</span>
<span id="cb706-5"><a href="statistical-analysis.html#cb706-5"></a>    weight_gain_ko1 <span class="op">=</span> rng.binomial(N, p, <span class="dv">100000</span>)<span class="op">/</span>N</span>
<span id="cb706-6"><a href="statistical-analysis.html#cb706-6"></a>    diff_weight_gain1 <span class="op">=</span> weight_gain_ko1 <span class="op">-</span> weight_gain_wt1</span>
<span id="cb706-7"><a href="statistical-analysis.html#cb706-7"></a>    power[i] <span class="op">=</span> np.mean(diff_weight_gain1 <span class="op">&gt;</span> <span class="fl">0.3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb707"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb707-1"><a href="statistical-analysis.html#cb707-1"></a>sns.lineplot(p1, power)</span>
<span id="cb707-2"><a href="statistical-analysis.html#cb707-2"></a>plt.axhline(<span class="fl">0.8</span>, color <span class="op">=</span> <span class="st">&#39;black&#39;</span>, linestyle <span class="op">=</span> <span class="st">&#39;--&#39;</span>)<span class="op">;</span></span>
<span id="cb707-3"><a href="statistical-analysis.html#cb707-3"></a>plt.ylabel(<span class="st">&#39;Statistical power&#39;</span>)</span>
<span id="cb707-4"><a href="statistical-analysis.html#cb707-4"></a>plt.xlabel(<span class="st">&#39;Proportion in KO mice&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb708"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb708-1"><a href="statistical-analysis.html#cb708-1"></a>np.<span class="bu">round</span>(p1[np.argmin(np.<span class="bu">abs</span>(power <span class="op">-</span> <span class="fl">0.8</span>))] <span class="op">-</span> <span class="fl">0.3</span>, <span class="dv">2</span>) <span class="co"># Find the location in the p1 array where power is closest to 0.8</span></span></code></pre></div>
<pre><code>0.48</code></pre>
<p>So to get to 80% power, we would need the true difference in proportion to be 0.48, or that at least 78% of KO mice should gain weight on average. This is quite a big difference, and its probably not very interesting scientifically to look for such a big difference, since it’s quite unlikely.</p>
<p>If we could afford 100 mice per arm, what would this look like?</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb710-1"><a href="statistical-analysis.html#cb710-1"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">304</span>)</span>
<span id="cb710-2"><a href="statistical-analysis.html#cb710-2"></a>N <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb710-3"><a href="statistical-analysis.html#cb710-3"></a>weight_gain_wt0 <span class="op">=</span> rng.binomial(N, <span class="fl">0.3</span>, <span class="dv">100000</span>)<span class="op">/</span>N <span class="co"># Get proportion</span></span>
<span id="cb710-4"><a href="statistical-analysis.html#cb710-4"></a>weight_gain_ko0 <span class="op">=</span> rng.binomial(N, <span class="fl">0.3</span>, <span class="dv">100000</span>)<span class="op">/</span>N <span class="co"># Assume first (null hypothesis) that there is no difference</span></span>
<span id="cb710-5"><a href="statistical-analysis.html#cb710-5"></a></span>
<span id="cb710-6"><a href="statistical-analysis.html#cb710-6"></a>diff_weight_gain0 <span class="op">=</span> weight_gain_ko0 <span class="op">-</span> weight_gain_wt0</span>
<span id="cb710-7"><a href="statistical-analysis.html#cb710-7"></a>cutoff <span class="op">=</span> np.quantile(diff_weight_gain0, <span class="fl">0.95</span>)</span>
<span id="cb710-8"><a href="statistical-analysis.html#cb710-8"></a></span>
<span id="cb710-9"><a href="statistical-analysis.html#cb710-9"></a>p1 <span class="op">=</span> np.linspace(<span class="fl">0.3</span>, <span class="fl">0.9</span>, <span class="dv">100</span>)</span>
<span id="cb710-10"><a href="statistical-analysis.html#cb710-10"></a>power <span class="op">=</span> np.zeros(<span class="bu">len</span>(p1))</span>
<span id="cb710-11"><a href="statistical-analysis.html#cb710-11"></a><span class="cf">for</span> i, p <span class="kw">in</span> <span class="bu">enumerate</span>(p1):</span>
<span id="cb710-12"><a href="statistical-analysis.html#cb710-12"></a>    weight_gain_wt1 <span class="op">=</span> rng.binomial(N, <span class="fl">0.3</span>, <span class="dv">100000</span>)<span class="op">/</span>N</span>
<span id="cb710-13"><a href="statistical-analysis.html#cb710-13"></a>    weight_gain_ko1 <span class="op">=</span> rng.binomial(N, p, <span class="dv">100000</span>)<span class="op">/</span>N</span>
<span id="cb710-14"><a href="statistical-analysis.html#cb710-14"></a>    diff_weight_gain1 <span class="op">=</span> weight_gain_ko1 <span class="op">-</span> weight_gain_wt1</span>
<span id="cb710-15"><a href="statistical-analysis.html#cb710-15"></a>    power[i] <span class="op">=</span> np.mean(diff_weight_gain1 <span class="op">&gt;</span> cutoff)</span>
<span id="cb710-16"><a href="statistical-analysis.html#cb710-16"></a></span>
<span id="cb710-17"><a href="statistical-analysis.html#cb710-17"></a>sns.lineplot(p1, power)</span>
<span id="cb710-18"><a href="statistical-analysis.html#cb710-18"></a>plt.axhline(<span class="fl">0.8</span>, color <span class="op">=</span> <span class="st">&#39;black&#39;</span>, linestyle <span class="op">=</span> <span class="st">&#39;--&#39;</span>)<span class="op">;</span></span>
<span id="cb710-19"><a href="statistical-analysis.html#cb710-19"></a>plt.ylabel(<span class="st">&#39;Statistical power&#39;</span>)</span>
<span id="cb710-20"><a href="statistical-analysis.html#cb710-20"></a>plt.xlabel(<span class="st">&#39;Proportion in KO mice&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb711"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb711-1"><a href="statistical-analysis.html#cb711-1"></a>np.<span class="bu">round</span>(p1[np.argmin(np.<span class="bu">abs</span>(power <span class="op">-</span> <span class="fl">0.8</span>))] <span class="op">-</span> <span class="fl">0.3</span>, <span class="dv">2</span>)</span></code></pre></div>
<pre><code>0.17</code></pre>
<p>The minimum detectable difference for 80% power is now down to 0.17, so we’d need the KO mice in truth to show weight gain 47% of the time, compared to 30% in WT mice. This is more reasonable scientifically as a query.</p>
</div>
<div id="a-permutation-test" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> A permutation test</h3>
<p>A permutation test is a 2-group test that asks whether two groups are different with respect to some metric. Let us look at a breast cancer proteomics experiment to illustrate this. The experimental data contains protein expression for over 12 thousand proteins, along with clinical data. We can ask, for example, whether a particular protein expression differs by ER status.</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb713-1"><a href="statistical-analysis.html#cb713-1"></a>brca <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/brca.csv&#39;</span>)</span>
<span id="cb713-2"><a href="statistical-analysis.html#cb713-2"></a>brca.head()</span></code></pre></div>
<pre><code>   Unnamed: 0 Complete TCGA ID  Gender  ...  NP_004065 NP_068752 NP_219494
0           0     TCGA-A2-A0CM  FEMALE  ...        NaN       NaN       NaN
1           1     TCGA-BH-A18Q  FEMALE  ...  -1.778435       NaN -3.069752
2           2     TCGA-A7-A0CE  FEMALE  ...        NaN       NaN       NaN
3           3     TCGA-D8-A142  FEMALE  ...        NaN       NaN       NaN
4           4     TCGA-AO-A0J6  FEMALE  ...        NaN       NaN -3.753616

[5 rows x 12585 columns]</code></pre>
<p>We will first do the classical t-test, that is available in the <code>scipy</code> package.</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb715-1"><a href="statistical-analysis.html#cb715-1"></a><span class="im">import</span> scipy <span class="im">as</span> sc</span>
<span id="cb715-2"><a href="statistical-analysis.html#cb715-2"></a><span class="im">import</span> statsmodels <span class="im">as</span> sm</span>
<span id="cb715-3"><a href="statistical-analysis.html#cb715-3"></a>test_probe <span class="op">=</span> <span class="st">&#39;NP_001193600&#39;</span></span>
<span id="cb715-4"><a href="statistical-analysis.html#cb715-4"></a></span>
<span id="cb715-5"><a href="statistical-analysis.html#cb715-5"></a>tst <span class="op">=</span> sc.stats.ttest_ind(brca[brca[<span class="st">&#39;ER Status&#39;</span>]<span class="op">==</span><span class="st">&#39;Positive&#39;</span>][test_probe], <span class="co"># Need [] since names have spaces</span></span>
<span id="cb715-6"><a href="statistical-analysis.html#cb715-6"></a>                   brca[brca[<span class="st">&#39;ER Status&#39;</span>]<span class="op">==</span><span class="st">&#39;Negative&#39;</span>][test_probe], </span>
<span id="cb715-7"><a href="statistical-analysis.html#cb715-7"></a>                  nan_policy <span class="op">=</span> <span class="st">&#39;omit&#39;</span>)</span>
<span id="cb715-8"><a href="statistical-analysis.html#cb715-8"></a>np.<span class="bu">round</span>(tst.pvalue, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>0.277</code></pre>
<p>The idea about a permutation test is that, if there is truly no difference then it shouldn’t make a difference if we shuffled the labels of ER status over the study individuals. That’s literally what we will do. We will do this several times, and look at the average difference in expression each time. This will form the null distribution under our assumption of no differences by ER status. We’ll then see where our observed data falls, and then be able to compute a p-value.</p>
<p>The difference between the simulations we just did and a permutation test is that the permutation test is based only on the observed data. No particular models are assumed and no new data is simulated. All we’re doing is shuffling the labels among the subjects, but keeping their actual data intact.</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb717-1"><a href="statistical-analysis.html#cb717-1"></a>nsim <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb717-2"><a href="statistical-analysis.html#cb717-2"></a></span>
<span id="cb717-3"><a href="statistical-analysis.html#cb717-3"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">294</span>)</span>
<span id="cb717-4"><a href="statistical-analysis.html#cb717-4"></a>x <span class="op">=</span> np.where(brca[<span class="st">&#39;ER Status&#39;</span>]<span class="op">==</span><span class="st">&#39;Positive&#39;</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb717-5"><a href="statistical-analysis.html#cb717-5"></a>y <span class="op">=</span> brca[test_probe].to_numpy()</span>
<span id="cb717-6"><a href="statistical-analysis.html#cb717-6"></a></span>
<span id="cb717-7"><a href="statistical-analysis.html#cb717-7"></a>obs_diff <span class="op">=</span> np.nanmean(y[x<span class="op">==</span><span class="dv">1</span>]) <span class="op">-</span> np.nanmean(y[x<span class="op">==-</span><span class="dv">1</span>])</span>
<span id="cb717-8"><a href="statistical-analysis.html#cb717-8"></a></span>
<span id="cb717-9"><a href="statistical-analysis.html#cb717-9"></a>diffs <span class="op">=</span> np.zeros(nsim)</span>
<span id="cb717-10"><a href="statistical-analysis.html#cb717-10"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nsim):</span>
<span id="cb717-11"><a href="statistical-analysis.html#cb717-11"></a>    x1 <span class="op">=</span> rng.permutation(x)</span>
<span id="cb717-12"><a href="statistical-analysis.html#cb717-12"></a>    diffs[i] <span class="op">=</span> np.nanmean(y[x1<span class="op">==</span><span class="dv">1</span>]) <span class="op">-</span> np.nanmean(y[x1 <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>])</span></code></pre></div>
<div class="sourceCode" id="cb718"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb718-1"><a href="statistical-analysis.html#cb718-1"></a>sns.distplot(diffs)</span>
<span id="cb718-2"><a href="statistical-analysis.html#cb718-2"></a>plt.axvline(x <span class="op">=</span> obs_diff, color <span class="op">=</span><span class="st">&#39;r&#39;</span>)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb719"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb719-1"><a href="statistical-analysis.html#cb719-1"></a>pval <span class="op">=</span> np.mean(np.<span class="bu">abs</span>(diffs) <span class="op">&gt;</span> np.<span class="bu">abs</span>(obs_diff))</span>
<span id="cb719-2"><a href="statistical-analysis.html#cb719-2"></a><span class="ss">f&quot;P-value from permutation test is </span><span class="sc">{</span>pval<span class="sc">}</span><span class="ss">&quot;</span></span></code></pre></div>
<pre><code>&#39;P-value from permutation test is 0.2606&#39;</code></pre>
<p>This is pretty close to what we got from the t-test</p>
</div>
<div id="testing-many-proteins" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Testing many proteins</h3>
<p>We could do the permutation test all the proteins using the array operations in <code>numpy</code></p>
<div class="sourceCode" id="cb721"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb721-1"><a href="statistical-analysis.html#cb721-1"></a>expr_names <span class="op">=</span> [u <span class="cf">for</span> u <span class="kw">in</span> <span class="bu">list</span>(brca.columns) <span class="cf">if</span> u.find(<span class="st">&#39;NP&#39;</span>) <span class="op">&gt;</span> <span class="op">-</span><span class="dv">1</span>] <span class="co"># Find all column names with NP</span></span>
<span id="cb721-2"><a href="statistical-analysis.html#cb721-2"></a></span>
<span id="cb721-3"><a href="statistical-analysis.html#cb721-3"></a>exprs <span class="op">=</span> brca[expr_names] <span class="co"># Extract the protein data</span></span></code></pre></div>
<div class="sourceCode" id="cb722"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb722-1"><a href="statistical-analysis.html#cb722-1"></a>x <span class="op">=</span> np.where(brca[<span class="st">&#39;ER Status&#39;</span>]<span class="op">==</span><span class="st">&#39;Positive&#39;</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb722-2"><a href="statistical-analysis.html#cb722-2"></a>obs_diffs <span class="op">=</span> exprs[x<span class="op">==</span><span class="dv">1</span>].mean(axis<span class="op">=</span><span class="dv">0</span>)<span class="op">-</span>exprs[x<span class="op">==-</span><span class="dv">1</span>].mean(axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb723"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb723-1"><a href="statistical-analysis.html#cb723-1"></a>nsim <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb723-2"><a href="statistical-analysis.html#cb723-2"></a>diffs <span class="op">=</span> np.zeros((nsim, exprs.shape[<span class="dv">1</span>]))</span>
<span id="cb723-3"><a href="statistical-analysis.html#cb723-3"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nsim):</span>
<span id="cb723-4"><a href="statistical-analysis.html#cb723-4"></a>    x1 <span class="op">=</span> rng.permutation(x)</span>
<span id="cb723-5"><a href="statistical-analysis.html#cb723-5"></a>    diffs[i,:] <span class="op">=</span>exprs[x1<span class="op">==</span><span class="dv">1</span>].mean(axis<span class="op">=</span><span class="dv">0</span>) <span class="op">-</span> exprs[x1<span class="op">==-</span><span class="dv">1</span>].mean(axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb724"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb724-1"><a href="statistical-analysis.html#cb724-1"></a>pvals <span class="op">=</span> np.zeros(exprs.shape[<span class="dv">1</span>])</span>
<span id="cb724-2"><a href="statistical-analysis.html#cb724-2"></a><span class="bu">len</span>(pvals)</span></code></pre></div>
<pre><code>12395</code></pre>
<div class="sourceCode" id="cb726"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb726-1"><a href="statistical-analysis.html#cb726-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(pvals)):</span>
<span id="cb726-2"><a href="statistical-analysis.html#cb726-2"></a>    pvals[i] <span class="op">=</span> np.mean(diffs[:,i] <span class="op">&gt;</span> obs_diffs.iloc[i])</span>
<span id="cb726-3"><a href="statistical-analysis.html#cb726-3"></a></span>
<span id="cb726-4"><a href="statistical-analysis.html#cb726-4"></a>sns.distplot(pvals)<span class="op">;</span></span></code></pre></div>
<p>This plot shows that there is probably some proteins which are differentially expressed between ER+ and ER- patients. (If no proteins had any difference, this histogram would be flat, since the p-values would be uniformly distributed). The ideas around Gene Set Enrichment Analysis (GSEA) can also be applied here.</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb727-1"><a href="statistical-analysis.html#cb727-1"></a>exprs_shortlist <span class="op">=</span> [u <span class="cf">for</span> i, u <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">list</span>(exprs.columns)) <span class="cf">if</span> pvals[i] <span class="op">&lt;</span> <span class="fl">0.0001</span> ]</span>
<span id="cb727-2"><a href="statistical-analysis.html#cb727-2"></a></span>
<span id="cb727-3"><a href="statistical-analysis.html#cb727-3"></a><span class="bu">len</span>(exprs_shortlist)</span></code></pre></div>
<pre><code>511</code></pre>
<p>This means that, if we considered a p-value cutoff for screening at 0.0001, we would select 486 of the 12395 proteins for further study.</p>
</div>
<div id="getting-a-confidence-interval-using-the-bootstrap" class="section level3" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Getting a confidence interval using the bootstrap</h3>
<p>We can use simulations to obtain a model-free confidence interval for particular parameters of interest based on our observed data. The technique we will demonstrate is called the bootstrap. The idea is that if we sample with replacement from our observed data to get another data set of the same size as the observed data, and compute our statistic of interest, and then repeat this process many times, then the distribution of our statistic that we will obtain this way will be very similar to the true sampling distribution of the statistic if we could “play God”. This has strong theoretical foundations from work done by several researchers in the 80s and 90s.</p>
<ol style="list-style-type: decimal">
<li>Choose the number of simulations <code>nsim</code></li>
<li>for each iteration (1,…,nsim)
<ul>
<li>Simulate a dataset with replacement from the original data.</li>
<li>compute and store the statistic</li>
</ul></li>
<li>Compute the 2.5th and 97.5th percential of the distribution of the statistic. This is your confidence interval.</li>
</ol>
<p>Let’s see this in action. Suppose we tossed a coin 100 times. We’re going to find a confidence interval for the proportion of heads from this coin.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb729-1"><a href="statistical-analysis.html#cb729-1"></a>rng <span class="op">=</span> np.random.RandomState(<span class="dv">304</span>)</span>
<span id="cb729-2"><a href="statistical-analysis.html#cb729-2"></a>x <span class="op">=</span> rng.binomial(<span class="dv">1</span>, <span class="fl">0.7</span>, <span class="dv">100</span>)</span>
<span id="cb729-3"><a href="statistical-analysis.html#cb729-3"></a>x</span></code></pre></div>
<pre><code>array([1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0,
       1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 0,
       1, 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1,
       1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1,
       1, 1, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1])</code></pre>
<p>This gives the sequence of heads (1) and tails (0), assuming the true probability of heads is 0.7.</p>
<p>We now create 100000 bootstrap samples from here.</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb731-1"><a href="statistical-analysis.html#cb731-1"></a>nsim <span class="op">=</span> <span class="dv">100000</span></span>
<span id="cb731-2"><a href="statistical-analysis.html#cb731-2"></a></span>
<span id="cb731-3"><a href="statistical-analysis.html#cb731-3"></a>boots <span class="op">=</span> np.random.choice(x, (<span class="bu">len</span>(x), nsim), replace <span class="op">=</span> <span class="va">True</span>) <span class="co"># sample from the data</span></span>
<span id="cb731-4"><a href="statistical-analysis.html#cb731-4"></a>boot_estimates <span class="op">=</span> boots.mean(axis <span class="op">=</span> <span class="dv">0</span>) <span class="co"># compute mean of each sample, i.e proportion of heads</span></span>
<span id="cb731-5"><a href="statistical-analysis.html#cb731-5"></a></span>
<span id="cb731-6"><a href="statistical-analysis.html#cb731-6"></a>sns.distplot(boot_estimates)<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb732"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb732-1"><a href="statistical-analysis.html#cb732-1"></a>np.quantile(boot_estimates, (<span class="fl">0.025</span>, <span class="fl">0.975</span>)) <span class="co"># Find 2.5 and 97.5-th percentiles</span></span></code></pre></div>
<pre><code>array([0.66, 0.83])</code></pre>
<p>So our 95% bootstrap confidence interval is (0.66, 0.83). Our true value of 0.7 certainly falls in it.</p>
</div>
</div>
<div id="classical-hypothesis-testing" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Classical hypothesis testing</h2>
<p>Python has the tools to do classic hypothesis testing as well. Several functions are available in the <code>scipy.stats</code> module. The commonly used tests that are available are as follows:</p>
<table>
<thead>
<tr class="header">
<th align="left">Function</th>
<th>Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>ttest_1samp</code></td>
<td>One-sample t-test</td>
</tr>
<tr class="even">
<td align="left"><code>ttest_ind</code></td>
<td>Two-sample t-test</td>
</tr>
<tr class="odd">
<td align="left"><code>ttest_rel</code></td>
<td>Paired t-test</td>
</tr>
<tr class="even">
<td align="left"><code>wilcoxon</code></td>
<td>Wilcoxon signed-rank test (nonparametric paired t-test)</td>
</tr>
<tr class="odd">
<td align="left"><code>ranksum</code></td>
<td>Wilcoxon rank-sum test (nonparametric 2-sample t-test)</td>
</tr>
<tr class="even">
<td align="left"><code>chi2_contingency</code></td>
<td>Chi-square test for independence</td>
</tr>
<tr class="odd">
<td align="left"><code>fisher_exact</code></td>
<td>Fisher’s exact test on a 2x2 contingency table</td>
</tr>
<tr class="even">
<td align="left"><code>f_oneway</code></td>
<td>One-way ANOVA</td>
</tr>
<tr class="odd">
<td align="left"><code>pearsonr</code></td>
<td>Testing for correlation</td>
</tr>
<tr class="even">
<td align="left"></td>
<td></td>
</tr>
</tbody>
</table>
<p>There are also several tests in <code>statsmodels.stats</code></p>
<table>
<thead>
<tr class="header">
<th align="left">Functions</th>
<th>Tests</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>proportions_ztest</code></td>
<td>Test for difference in proportions</td>
</tr>
<tr class="even">
<td align="left"><code>mcnemar</code></td>
<td>McNemar’s test</td>
</tr>
<tr class="odd">
<td align="left"><code>sign_test</code></td>
<td>Sign test</td>
</tr>
<tr class="even">
<td align="left"><code>multipletests</code></td>
<td>p-value correction for multiple tests</td>
</tr>
<tr class="odd">
<td align="left"><code>fdrcorrection</code></td>
<td>p-value correction by FDR</td>
</tr>
<tr class="even">
<td align="left"></td>
<td></td>
</tr>
</tbody>
</table>
<p>We’ve seen an example of these tests earlier. .</p>
</div>
<div id="regression-analysis" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Regression analysis</h2>
<p>The regression modeling frameworks in Python are mainly in <code>statsmodels</code>, though some of it can be found in <code>scikit-learn</code> which we will see tomorrow. We will use the diamonds dataset for demonstration purposes. We will attempt to model the diamond price against several of the other diamond characteristics.</p>
<div class="sourceCode" id="cb734"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb734-1"><a href="statistical-analysis.html#cb734-1"></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb734-2"><a href="statistical-analysis.html#cb734-2"></a><span class="im">import</span> statsmodels.formula.api <span class="im">as</span> smf <span class="co"># Use the formula interface to statsmodels</span></span>
<span id="cb734-3"><a href="statistical-analysis.html#cb734-3"></a></span>
<span id="cb734-4"><a href="statistical-analysis.html#cb734-4"></a>mod1 <span class="op">=</span> smf.glm(<span class="st">&#39;price ~ carat + clarity + depth + cut + color&#39;</span>, data <span class="op">=</span> diamonds).fit()</span></code></pre></div>
<div class="sourceCode" id="cb735"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb735-1"><a href="statistical-analysis.html#cb735-1"></a>mod1.summary()</span></code></pre></div>
<pre><code>&lt;class &#39;statsmodels.iolib.summary.Summary&#39;&gt;
&quot;&quot;&quot;
                 Generalized Linear Model Regression Results                  
==============================================================================
Dep. Variable:                  price   No. Observations:                53940
Model:                            GLM   Df Residuals:                    53920
Model Family:                Gaussian   Df Model:                           19
Link Function:               identity   Scale:                      1.3382e+06
Method:                          IRLS   Log-Likelihood:            -4.5699e+05
Date:                Fri, 22 May 2020   Deviance:                   7.2158e+10
Time:                        01:06:48   Pearson chi2:                 7.22e+10
No. Iterations:                     3                                         
Covariance Type:            nonrobust                                         
====================================================================================
                       coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------------
Intercept        -6902.0434    245.309    -28.136      0.000   -7382.839   -6421.247
clarity[T.IF]     5415.0087     52.191    103.754      0.000    5312.717    5517.301
clarity[T.SI1]    3571.3831     44.613     80.053      0.000    3483.944    3658.822
clarity[T.SI2]    2623.0139     44.813     58.532      0.000    2535.181    2710.846
clarity[T.VS1]    4531.3874     45.570     99.437      0.000    4442.071    4620.704
clarity[T.VS2]    4214.9672     44.865     93.948      0.000    4127.033    4302.901
clarity[T.VVS1]   5068.3553     48.248    105.049      0.000    4973.792    5162.919
clarity[T.VVS2]   4963.7218     46.924    105.781      0.000    4871.752    5055.692
cut[T.Good]        644.1406     34.173     18.849      0.000     577.162     711.119
cut[T.Ideal]       982.1534     31.780     30.905      0.000     919.866    1044.441
cut[T.Premium]     849.9079     32.551     26.110      0.000     786.110     913.706
cut[T.Very Good]   833.2870     32.291     25.806      0.000     769.998     896.576
color[T.E]        -211.8364     18.316    -11.566      0.000    -247.734    -175.939
color[T.F]        -303.2741     18.509    -16.385      0.000    -339.551    -266.997
color[T.G]        -505.3602     18.127    -27.879      0.000    -540.888    -469.832
color[T.H]        -977.5332     19.281    -50.699      0.000   -1015.323    -939.743
color[T.I]       -1439.0796     21.655    -66.455      0.000   -1481.523   -1396.636
color[T.J]       -2323.8709     26.731    -86.935      0.000   -2376.263   -2271.479
carat             8885.8162     12.034    738.362      0.000    8862.229    8909.403
depth               -7.1602      3.727     -1.921      0.055     -14.464       0.144
====================================================================================
&quot;&quot;&quot;</code></pre>
<p>This is the basic syntax for modeling in statsmodels. Let’s go through and parse it.</p>
<p>One thing you notice is that we’ve written a formula inside the model</p>
<pre><code>mod1 = smf.glm(&#39;price ~ carat + clarity + depth + cut + color&#39;, data = diamonds).fit()</code></pre>
<p>This is based on another Python package, <code>patsy</code>, which allows us to write the model like this. This will read as
“price depends on carat, clarity, depth, cut and color”. Underneath a lot is going on.</p>
<ol style="list-style-type: decimal">
<li>color, clarity, and cut are all categorical variables. They actually need to be expanded into dummy variables, so we will have one column for each category level, which is 1 when the diamond is of that category and 0 otherwise.</li>
<li>An intercept terms is added</li>
<li>The dummy variables are concatenated to the continuous variables</li>
<li>The model is run</li>
</ol>
<p>We can see the dummy variables using <code>pandas</code></p>
<div class="sourceCode" id="cb738"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb738-1"><a href="statistical-analysis.html#cb738-1"></a>pd.get_dummies(diamonds)</span></code></pre></div>
<pre><code>       carat  depth  table  ...  clarity_VS2  clarity_VVS1  clarity_VVS2
0       0.23   61.5   55.0  ...            0             0             0
1       0.21   59.8   61.0  ...            0             0             0
2       0.23   56.9   65.0  ...            0             0             0
3       0.29   62.4   58.0  ...            1             0             0
4       0.31   63.3   58.0  ...            0             0             0
...      ...    ...    ...  ...          ...           ...           ...
53935   0.72   60.8   57.0  ...            0             0             0
53936   0.72   63.1   55.0  ...            0             0             0
53937   0.70   62.8   60.0  ...            0             0             0
53938   0.86   61.0   58.0  ...            0             0             0
53939   0.75   62.2   55.0  ...            0             0             0

[53940 rows x 27 columns]</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization-using-python.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="machine-learning-using-python.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 1
},
"edit": {
"link": "https://github.com/ARAASTAT/BIOF085/edit/master/book/04_python_stat.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["BIOF085_Manual.pdf", "https://github.com/ARAASTAT/BIOF085/raw/master/book/04_python_stat.Rmd"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
